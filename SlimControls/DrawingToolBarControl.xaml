<UserControl x:Class="SlimControls.DrawingToolBarControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:SlimControls"
             mc:Ignorable="d" 
             DataContext="{Binding DrawingToolsView}"
             d:DesignHeight="450" d:DesignWidth="800">

    <!-- ✅ Resource dictionary must be here -->
    <UserControl.Resources>
        <local:ShapeToolVisibleConverter x:Key="ShapeToolVisibleConverter" />
    </UserControl.Resources>

    <Grid>
        <TabControl>

            <TabItem Header="Tools">
                <StackPanel Orientation="Horizontal">

                    <!-- Shape Tool -->
                    <ToggleButton Content="Shapes"
                                  Command="{Binding SelectTool}"
                                  CommandParameter="Shape" />

                    <!-- Inline shape picker -->
                    <StackPanel Orientation="Horizontal"
                                Visibility="{Binding ToolState.ActiveTool,
                                    Converter={StaticResource ShapeToolVisibleConverter}}">
                        <ToggleButton Content="Rectangle" Command="{Binding SelectShape}" CommandParameter="Rectangle"/>
                        <ToggleButton Content="Ellipse" Command="{Binding SelectShape}" CommandParameter="Ellipse"/>
                        <ToggleButton Content="Freeform" Command="{Binding SelectShape}" CommandParameter="Freeform"/>
                    </StackPanel>

                    <!-- Pencil -->
                    <ToggleButton Content="Pencil"
                                  Command="{Binding SelectTool}"
                                  CommandParameter="Pencil"/>

                    <!-- Eraser -->
                    <ToggleButton Content="Eraser"
                                  Command="{Binding SelectTool}"
                                  CommandParameter="Eraser"/>
                </StackPanel>
            </TabItem>

            <TabItem Header="Options">
                <StackPanel>
                    <CheckBox Content="Fill" IsChecked="{Binding State.UseFill}" />
                    <CheckBox Content="Texture" IsChecked="{Binding State.UseTexture}" />
                    <ComboBox ItemsSource="{Binding Textures}" SelectedItem="{Binding State.TextureName}" />
                    <ComboBox ItemsSource="{Binding Filters}" SelectedItem="{Binding State.Filter}" />
                </StackPanel>
            </TabItem>

        </TabControl>
    </Grid>
</UserControl>
